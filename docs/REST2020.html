<!DOCTYPE html>
<html lang='en'>
<head><title>Summarized stats for REST2020_REST_Redlands</title></head>
<link rel='stylesheet' href='https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/css/calcite-web.min.css'>
<body>
<table class='table table-blue' style='max-width:550px'><thead>
<tr><th>Name</th><th>Completed</th><th>Miles</th><th>Segments Done</th><th>Segments Left</th></tr></thead>
<tbody><tr><td>Bjorn</td><td> 83.7%</td><td> 418.1 mi</td><td> 2806</td><td>  597</td></tr>
<tr><td>Kylie</td><td> 78.6%</td><td> 392.3 mi</td><td> 2682</td><td>  721</td></tr>
<tr><td>Erwin</td><td> 75.1%</td><td> 375.1 mi</td><td> 2450</td><td>  953</td></tr>
<tr><td>Alan </td><td> 71.3%</td><td> 356.3 mi</td><td> 2323</td><td> 1080</td></tr>
<tr><td>Zara </td><td> 47.5%</td><td> 237.3 mi</td><td> 1676</td><td> 1727</td></tr>
<tr><td>Joe  </td><td> 29.8%</td><td> 148.9 mi</td><td> 1081</td><td> 2322</td></tr>
<tr><td>Chris</td><td>  5.2%</td><td>  26.1 mi</td><td>  186</td><td> 3217</td></tr>
<tbody></table>
<div>Total: 499.4 miles / 803.7 km</div>
<div><small>Last updated Fri Feb 19 21:15:47 2021
</small></div><script src='https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/js/calcite-web.min.js'></script>
<hr><div id='lastEditDate'></div><script>
  const featurelayer = 'https://services.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/rest/services/REST2020_REST_Redlands/FeatureServer/1';
  const mapdata = '<a href="' + featurelayer + '">Map data</a>'
  getSomething('lastEditDate', featurelayer + '?f=json'); 
  function getSomething(specificDiv, URL) {
      fetch(URL, {method: 'GET'})
        .then(function(response) {
          let theDiv = document.getElementById(specificDiv);
          theDiv.innerHTML += mapdata;
          if (!response.ok) {
            theDiv.innerHTML += 'PROBLEM! - response not ok --- ' + response.status + ' -- ' + link + '<br>';
            return;
          }
          return response.json();
       }).then(function(json) {
          let theDiv = document.getElementById(specificDiv);
          var propertyNames = Object.keys(json);
          if (propertyNames.length < 1) {
            theDiv.innerHTML += 'PROBLEM! - json should not be empty --- ' + link + '<br>';
            return;
          }
          const date1 = new Date(json.editingInfo.lastEditDate);
          theDiv.innerHTML += ' last updated at ' + date1 + '.';
        }).catch(error => {
          console.error('My error 101:', error);
        });
    }
</script>
</body></html>
